var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,n,s){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function r(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function p(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t){return function(e){return e.preventDefault(),t.call(this,e)}}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e,n){t.classList[n?"add":"remove"](e)}let h;function b(t){h=t}function w(){if(!h)throw new Error("Function called outside component initialization");return h}function y(){const t=w();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const o=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,o)}))}}}const x=[],k=[],_=[],S=[],E=Promise.resolve();let z=!1;function C(t){_.push(t)}const L=new Set;let O=0;function P(){const t=h;do{for(;O<x.length;){const t=x[O];O++,b(t),M(t.$$)}for(b(null),x.length=0,O=0;k.length;)k.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];L.has(e)||(L.add(e),e())}_.length=0}while(x.length);for(;S.length;)S.pop()();z=!1,L.clear(),b(t)}function M(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const N=new Set;let T;function j(){T={r:0,c:[],p:T}}function I(){T.r||s(T.c),T=T.p}function q(t,e){t&&t.i&&(N.delete(t),t.i(e))}function A(t,e,n,s){if(t&&t.o){if(N.has(t))return;N.add(t),T.c.push((()=>{N.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function J(t){t&&t.c()}function B(t,n,a,l){const{fragment:r,on_mount:i,on_destroy:u,after_update:c}=t.$$;r&&r.m(n,a),l||C((()=>{const n=i.map(e).filter(o);u?u.push(...n):s(n),t.$$.on_mount=[]})),c.forEach(C)}function D(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function F(t,e){-1===t.$$.dirty[0]&&(x.push(t),z||(z=!0,E.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,o,a,l,r,i,c,d=[-1]){const f=h;b(e);const p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||f.$$.root};c&&c(p.root);let m=!1;if(p.ctx=a?a(e,o.props||{},((t,n,...s)=>{const o=s.length?s[0]:n;return p.ctx&&r(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),m&&F(e,t)),n})):[],p.update(),m=!0,s(p.before_update),p.fragment=!!l&&l(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();o.intro&&q(e.$$.fragment),B(e,o.target,o.anchor,o.customElement),P()}b(f)}class U{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const W=[];const G={state:"loggedout",username:null,userid:null,authtoken:null},K=function(e,n=t){let s;const o=new Set;function l(t){if(a(e,t)&&(e=t,s)){const t=!W.length;for(const t of o)t[1](),W.push(t,e);if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(a,r=t){const i=[a,r];return o.add(i),1===o.size&&(s=n(l)||t),a(e),()=>{o.delete(i),0===o.size&&(s(),s=null)}}}}(G),Q={subscribe:K.subscribe,appStarted:()=>{const t=localStorage.getItem("todo-auth-state");if(t){let e=JSON.parse(t);e={...e,state:"loggedin"},K.set(e)}},setLoggedOff:()=>{K.set(G),localStorage.removeItem("todo-auth-state")},setSignup:()=>{const t={...G,state:"signup"};K.set(t)},setLogin:()=>{const t={...G,state:"login"};K.set(t)},setLoggedIn:(t,e,n)=>{K.set({state:"loggedin",username:t,userid:e,authtoken:n}),localStorage.setItem("todo-auth-state",JSON.stringify({username:t,userid:e,authtoken:n}))}};function R(e){let n,o,a,l,d,$,v;return{c(){n=c("li"),o=c("a"),o.textContent="Login",a=f(),l=c("li"),d=c("a"),d.textContent="Signup",g(o,"href","/"),g(o,"class","button svelte-wzpv7m"),g(n,"class","svelte-wzpv7m"),g(d,"href","/"),g(d,"class","button svelte-wzpv7m"),g(l,"class","svelte-wzpv7m")},m(t,s){i(t,n,s),r(n,o),i(t,a,s),i(t,l,s),r(l,d),$||(v=[p(o,"click",m(e[2])),p(d,"click",m(e[3]))],$=!0)},p:t,d(t){t&&u(n),t&&u(a),t&&u(l),$=!1,s(v)}}}function V(t){let e,n,s,o,a,l,v,h,b=t[0].username+"";return{c(){e=c("li"),n=c("span"),s=d(b),o=f(),a=c("li"),l=c("a"),l.textContent="Logout",g(n,"class","username"),g(e,"class","svelte-wzpv7m"),g(l,"href","/"),g(l,"class","button svelte-wzpv7m"),g(a,"class","svelte-wzpv7m")},m(u,c){i(u,e,c),r(e,n),r(n,s),i(u,o,c),i(u,a,c),r(a,l),v||(h=p(l,"click",m(t[1])),v=!0)},p(t,e){1&e&&b!==(b=t[0].username+"")&&$(s,b)},d(t){t&&u(e),t&&u(o),t&&u(a),v=!1,h()}}}function X(e){let n,s,o,a,l;function d(t,e){return"loggedin"===t[0].state?V:R}let p=d(e),m=p(e);return{c(){n=c("header"),s=c("nav"),o=c("ul"),a=c("li"),a.innerHTML='<h1><a href="/" class="svelte-wzpv7m"><span class="fas fa-tasks svelte-wzpv7m" aria-hidden="true"></span> \n            <span>Todopad</span></a></h1>',l=f(),m.c(),g(a,"class","svelte-wzpv7m"),g(o,"class","svelte-wzpv7m"),g(s,"class","svelte-wzpv7m")},m(t,e){i(t,n,e),r(n,s),r(s,o),r(o,a),r(o,l),m.m(o,null)},p(t,[e]){p===(p=d(t))&&m?m.p(t,e):(m.d(1),m=p(t),m&&(m.c(),m.m(o,null)))},i:t,o:t,d(t){t&&u(n),m.d()}}}function Y(t,e,n){let s;l(t,Q,(t=>n(0,s=t)));return[s,()=>Q.setLoggedOff(),()=>Q.setLogin(),()=>Q.setSignup()]}class Z extends U{constructor(t){super(),H(this,t,Y,X,a,{})}}function tt(t){let e,n;return{c(){e=c("p"),n=d(t[4]),g(e,"class","error-message svelte-qk26dr")},m(t,s){i(t,e,s),r(e,n)},p(t,e){16&e&&$(n,t[4])},d(t){t&&u(e)}}}function et(e){let n,s,o,a,l,m,h,b,w=e[6]&&tt(e);return{c(){n=c("div"),s=c("label"),o=d(e[1]),a=f(),l=c("input"),m=f(),w&&w.c(),g(s,"for",e[0]),g(s,"class","svelte-qk26dr"),g(l,"type",e[3]),g(l,"id",e[0]),l.value=e[2],g(l,"class","svelte-qk26dr"),v(l,"invalid",e[6]),g(n,"class","form-control svelte-qk26dr")},m(t,u){i(t,n,u),r(n,s),r(s,o),r(n,a),r(n,l),e[11](l),r(n,m),w&&w.m(n,null),h||(b=p(l,"input",e[7]),h=!0)},p(t,[e]){2&e&&$(o,t[1]),1&e&&g(s,"for",t[0]),8&e&&g(l,"type",t[3]),1&e&&g(l,"id",t[0]),4&e&&l.value!==t[2]&&(l.value=t[2]),64&e&&v(l,"invalid",t[6]),t[6]?w?w.p(t,e):(w=tt(t),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i:t,o:t,d(t){t&&u(n),e[11](null),w&&w.d(),h=!1,b()}}}function nt(t,e,n){let s;const o=y();let a,{id:l}=e,{label:r}=e,{value:i}=e,{type:u}=e,{autofocus:c=0}=e,{valid:d=!0}=e,{validityMessage:f=""}=e;var p;p=()=>{c&&a.focus()},w().$$.on_mount.push(p);let m=!1;return t.$$set=t=>{"id"in t&&n(0,l=t.id),"label"in t&&n(1,r=t.label),"value"in t&&n(2,i=t.value),"type"in t&&n(3,u=t.type),"autofocus"in t&&n(8,c=t.autofocus),"valid"in t&&n(9,d=t.valid),"validityMessage"in t&&n(4,f=t.validityMessage)},t.$$.update=()=>{1552&t.$$.dirty&&n(6,s=!d&&f&&m)},[l,r,i,u,f,a,s,function(t){n(10,m=!0),o("input",t)},c,d,m,function(t){k[t?"unshift":"push"]((()=>{a=t,n(5,a)}))}]}class st extends U{constructor(t){super(),H(this,t,nt,et,a,{id:0,label:1,value:2,type:3,autofocus:8,valid:9,validityMessage:4})}}function ot(t){return 0===t.trim().length}function at(t){return!/^((?!\.)[\w\-_.]*[^.])(@\w+)(\.\w+(\.\w+)?[^.\W])$/.test(t)}function lt(t){let e,n;return e=new st({props:{id:"name",label:"Name",type:"text",value:t[1],valid:!ot(t[1]),validityMessage:"Please enter your name",autofocus:"true"}}),e.$on("input",t[9]),{c(){J(e.$$.fragment)},m(t,s){B(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.value=t[1]),2&n&&(s.valid=!ot(t[1])),e.$set(s)},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function rt(t){let e,n;return{c(){e=c("p"),n=d(t[4]),g(e,"class","error svelte-1s4bhta")},m(t,s){i(t,e,s),r(e,n)},p(t,e){16&e&&$(n,t[4])},d(t){t&&u(e)}}}function it(t){let e,n,o,a,l,$,v,h,b,w,y,x,k,_,S,E,z,C,L=t[0]&&lt(t);l=new st({props:{id:"email",label:"Email",type:"email",value:t[2],valid:!at(t[2]),validityMessage:"Please enter valid email",autofocus:!t[0]}}),l.$on("input",t[10]),v=new st({props:{id:"password",label:"Password",type:"password",value:t[3],valid:!ot(t[3]),validityMessage:"Please enter your password"}}),v.$on("input",t[11]);let O=t[4]&&rt(t);return{c(){e=c("form"),n=c("h2"),n.textContent=`${t[6]}`,o=f(),L&&L.c(),a=f(),J(l.$$.fragment),$=f(),J(v.$$.fragment),h=f(),b=c("div"),w=c("button"),y=d(t[6]),k=f(),_=c("button"),_.textContent="Cancel",S=f(),O&&O.c(),g(n,"class","svelte-1s4bhta"),w.disabled=x=!t[5](),g(w,"class","svelte-1s4bhta"),g(_,"class","svelte-1s4bhta"),g(b,"class","controls svelte-1s4bhta"),g(e,"class","svelte-1s4bhta")},m(s,u){var c;i(s,e,u),r(e,n),r(e,o),L&&L.m(e,null),r(e,a),B(l,e,null),r(e,$),B(v,e,null),r(e,h),r(e,b),r(b,w),r(w,y),r(b,k),r(b,_),r(b,S),O&&O.m(b,null),E=!0,z||(C=[p(w,"click",(c=m(t[8]),function(t){return t.stopPropagation(),c.call(this,t)})),p(_,"click",t[7])],z=!0)},p(t,[n]){t[0]?L?(L.p(t,n),1&n&&q(L,1)):(L=lt(t),L.c(),q(L,1),L.m(e,a)):L&&(j(),A(L,1,1,(()=>{L=null})),I());const s={};4&n&&(s.value=t[2]),4&n&&(s.valid=!at(t[2])),1&n&&(s.autofocus=!t[0]),l.$set(s);const o={};8&n&&(o.value=t[3]),8&n&&(o.valid=!ot(t[3])),v.$set(o),(!E||32&n&&x!==(x=!t[5]()))&&(w.disabled=x),t[4]?O?O.p(t,n):(O=rt(t),O.c(),O.m(b,null)):O&&(O.d(1),O=null)},i(t){E||(q(L),q(l.$$.fragment,t),q(v.$$.fragment,t),E=!0)},o(t){A(L),A(l.$$.fragment,t),A(v.$$.fragment,t),E=!1},d(t){t&&u(e),L&&L.d(),D(l),D(v),O&&O.d(),z=!1,s(C)}}}function ut(t,e,n){let s,{signup:o=!1}=e,a=o?"Signup":"Login",l="",r="",i="",u=null;return t.$$set=t=>{"signup"in t&&n(0,o=t.signup)},t.$$.update=()=>{15&t.$$.dirty&&n(5,s=()=>{let t=!ot(i)&&!at(r);return o&&(t=t&&!ot(l)),t})},[o,l,r,i,u,s,a,function(){Q.setLoggedOff()},async function(){if(n(4,u=null),s())try{let t;t=o?await async function(t,e,n){const s={method:"POST",body:JSON.stringify({name:t,email:e,password:n}),headers:{"Content-Type":"application/json"}},o=await fetch("/signup",s);if(!o.ok){const t=await o.text();if(console.log(t),409===o.status)throw"Email already exists. Please login if you have registered already.";throw t}return await o.json()}(l,r,i):await async function(t,e){const n={method:"POST",body:JSON.stringify({email:t,password:e}),headers:{"Content-Type":"application/json"}},s=await fetch("/login",n);if(!s.ok){const t=await s.text();if(console.log(t),404===s.status)throw"Email not found. Please login with valid credentials.";if(403===s.status)throw"Invalid Credentials. Please login with valid credentials.";throw t}return await s.json()}(r,i),Q.setLoggedIn(t.name,t.userid,t.token)}catch(t){n(4,u=t)}else n(4,u="invalid form")},t=>n(1,l=t.detail.target.value),t=>n(2,r=t.detail.target.value),t=>n(3,i=t.detail.target.value)]}class ct extends U{constructor(t){super(),H(this,t,ut,it,a,{signup:0})}}function dt(e){let n;return{c(){n=c("h1"),n.textContent="Unknown state"},m(t,e){i(t,n,e)},i:t,o:t,d(t){t&&u(n)}}}function ft(e){let n;return{c(){n=d("Show tasks")},m(t,e){i(t,n,e)},i:t,o:t,d(t){t&&u(n)}}}function pt(t){let e,n;return e=new ct({}),{c(){J(e.$$.fragment)},m(t,s){B(e,t,s),n=!0},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function mt(t){let e,n;return e=new ct({props:{signup:!0}}),{c(){J(e.$$.fragment)},m(t,s){B(e,t,s),n=!0},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function gt(e){let n;return{c(){n=c("h1"),n.textContent="Signin please"},m(t,e){i(t,n,e)},i:t,o:t,d(t){t&&u(n)}}}function $t(t){let e,n,s,o;const a=[gt,mt,pt,ft,dt],l=[];function r(t,e){return"loggedout"===t[0].state?0:"signup"===t[0].state?1:"login"===t[0].state?2:"loggedin"===t[0].state?3:4}return n=r(t),s=l[n]=a[n](t),{c(){e=c("div"),s.c()},m(t,s){i(t,e,s),l[n].m(e,null),o=!0},p(t,[o]){let i=n;n=r(t),n!==i&&(j(),A(l[i],1,1,(()=>{l[i]=null})),I(),s=l[n],s||(s=l[n]=a[n](t),s.c()),q(s,1),s.m(e,null))},i(t){o||(q(s),o=!0)},o(t){A(s),o=!1},d(t){t&&u(e),l[n].d()}}}function vt(t,e,n){let s;return l(t,Q,(t=>n(0,s=t))),[s]}class ht extends U{constructor(t){super(),H(this,t,vt,$t,a,{})}}function bt(e){let n,s,o,a,l;return s=new Z({}),a=new ht({}),{c(){n=c("div"),J(s.$$.fragment),o=f(),J(a.$$.fragment)},m(t,e){i(t,n,e),B(s,n,null),r(n,o),B(a,n,null),l=!0},p:t,i(t){l||(q(s.$$.fragment,t),q(a.$$.fragment,t),l=!0)},o(t){A(s.$$.fragment,t),A(a.$$.fragment,t),l=!1},d(t){t&&u(n),D(s),D(a)}}}function wt(t){return Q.appStarted(),[]}return new class extends U{constructor(t){super(),H(this,t,wt,bt,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
