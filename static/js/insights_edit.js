(()=>{var L=(()=>{let a=[],c=[],d=-1;function u(){let e=document.getElementById("tag-input"),n=document.getElementById("tag-container"),s=document.getElementById("tags-hidden"),t=document.getElementById("tag-suggestions");a=s.value?s.value.split(",").map(i=>i.trim()).filter(i=>i.length>0):[],o(),E(),e.addEventListener("input",()=>f(e.value)),e.addEventListener("keydown",i=>p(i,e)),document.addEventListener("click",i=>{!n.contains(i.target)&&!t.contains(i.target)&&t.classList.add("hidden")})}function o(){let e=document.getElementById("tag-container"),n=document.getElementById("tag-input"),s=document.getElementById("tags-hidden");e.innerHTML="",a.forEach(t=>{let i=document.createElement("div");i.className="bg-gray-200 text-sm px-2 py-1 m-1 rounded flex items-center",i.innerHTML=`${t} <span class="ml-2 cursor-pointer text-red-500" onclick="TagManager.removeTag('${t}')">&times;</span>`,e.appendChild(i)}),e.appendChild(n),s.value=a.join(",")}function m(e){a=a.filter(n=>n!==e),o()}function f(e){let n=document.getElementById("tag-input"),s=document.getElementById("tag-suggestions"),t=c.filter(i=>i.toLowerCase().includes(e.toLowerCase()));h(t,n,s)}function h(e,n,s){if(s.innerHTML="",d=-1,e.length===0){s.classList.add("hidden");return}s.classList.remove("hidden"),s.style.width=`${n.offsetWidth}px`,e.forEach((t,i)=>{let l=document.createElement("li");l.className="px-2 py-1 cursor-pointer hover:bg-gray-100",l.textContent=t,l.setAttribute("data-index",i),l.addEventListener("click",()=>r(t)),s.appendChild(l)})}function p(e,n){let s=document.getElementById("tag-suggestions"),t=s.querySelectorAll("li");e.key==="ArrowDown"&&t.length>0?(e.preventDefault(),d<t.length-1&&d++,g(t)):e.key==="ArrowUp"&&t.length>0?(e.preventDefault(),d>0&&d--,g(t)):e.key==="Enter"?(e.preventDefault(),d>=0&&d<t.length?r(t[d].textContent):y(n.value.trim()),n.value="",s.classList.add("hidden"),n.focus()):e.key==="Backspace"&&n.value===""&&(a.pop(),o())}function g(e){e.forEach((n,s)=>{s===d?n.classList.add("bg-gray-300"):n.classList.remove("bg-gray-300")})}function r(e){a.includes(e)||(a.push(e),o()),document.getElementById("tag-input").value="",document.getElementById("tag-suggestions").classList.add("hidden")}function y(e){e&&!a.includes(e)&&(a.push(e),o())}function E(){fetch("/tags").then(e=>e.json()).then(e=>{c=e.tags||[]}).catch(e=>console.error("Error fetching tags:",e))}return{init:u,removeTag:m}})();document.addEventListener("DOMContentLoaded",()=>L.init());})();
